<template>
  <div id="app">
    <FixedElements/>
    <Sidebar/>
    <div id="main">
    <video-block 
           :author="author"
           :permlink="permlink"
           :ap="true"
           :muted="false"
           :controls="true"
              />
    <div id="nUpvotes">{{ upvotes.length; }}</div>
    <div id="upvoters" v-if="upvotesHovered">
      <div v-for="u in upvotes" class="upvoter">
        {{ u.name }} {{ u.power }}
      </div>
    </div>
  </div>
  </div>
</template>

<script>
  var queryString = require('query-string')
  var golos = require('golos-js')
  import VideoBlock from './VideoBlock.vue'
  import FixedElements from './FixedElements.vue'
  import Sidebar from './Sidebar.vue'
  import Category from './Category.vue'
  export default {
    name: 'app',

    components: {
      FixedElements,
      Sidebar,
      VideoBlock,
    },

    data: function() {
      return {
        author: "",
        permlink: "",
        upvotes: [],  
      };
    },

    created: function() {
      var vm = this;
      var queries = queryString.parse(location.search);
      vm.author = queries.a;
      vm.permlink = queries.v;
      golos.api.getContent(vm.author, vm.permlink, function(err, result) {
        if (!err) {
          result.active_votes.forEach(function(item, i, arr) {
            vm.upvotes.push({
                              name: item.voter, 
                              power: 
                            })
          });
        }
        else console.error(err);
      });
    }
  }
</script>

<style>
#app {
  padding-top: 4em;
}

#main {
  margin-left: 12.5em;
}

video {
  width: 80%;
}
</style>
